# 气候数据处理脚本使用说明

## 功能说明
这个脚本用于处理气候数据，根据每天的原始数据计算3天、5天、7天和10天的统计值。

## 快速开始
1. 确保已安装所需的Python库：
   ```bash
   pip install pandas openpyxl numpy
   ```

2. 将G1099.xlsx文件放在脚本同一目录

3. 运行脚本：
   ```bash
   python process_climate_data.py
   ```

4. 查看生成的输出文件：
   - 影响因子1103.xlsx
   - 影响因子1103.csv

## 输入数据要求
Excel文件（G1099.xlsx）应包含以下列（按顺序）：
1. 日期
2. 平均气温
3. 雨量
4. 相对湿度
5. 降雨时数
6. 日照时数

## 计算规则
- **平均气温**：计算窗口内所有日期的平均值
- **累积雨量**：计算窗口内所有日期的累计和
- **平均相对湿度**：计算窗口内所有日期的平均值
- **累积降雨时数**：计算窗口内所有日期的累计和
- **累积日照时数**：计算窗口内所有日期的累计和

### 特殊处理
- 如果某一天前面没有足够的天数（如第1天计算3天平均值时，只有1天的数据），则使用已有的天数计算
- 例如：2019年1月1日的3天平均值=当天值，1月2日=前2天平均值，1月3日=前3天平均值

## 输出结果
脚本会生成以下文件：
1. **影响因子1103.xlsx** - Excel格式的输出文件
2. **影响因子1103.csv** - CSV格式的输出文件

## 运行方法

### 方法1：命令行运行
```bash
python process_climate_data.py
```

### 方法2：在Python环境中运行
```python
import process_climate_data
process_climate_data.main()
```

## 依赖库
- pandas
- openpyxl（用于读写Excel文件）
- numpy

安装依赖：
```bash
pip install pandas openpyxl numpy
```

## 计算示例
假设有3天的数据：
- 第1天：气温20°C，雨量5mm，湿度60%，降雨2小时，日照8小时
- 第2天：气温22°C，雨量3mm，湿度65%，降雨1小时，日照7小时  
- 第3天：气温25°C，雨量0mm，湿度70%，降雨0小时，日照9小时

对于第3天的3天统计值：
- 3天平均气温 = (20+22+25)/3 = 22.33°C
- 3天累积雨量 = 5+3+0 = 8mm
- 3天平均相对湿度 = (60+65+70)/3 = 65%
- 3天累积降雨时数 = 2+1+0 = 3小时
- 3天累积日照时数 = 8+7+9 = 24小时

对于第1天的3天统计值（只有1天数据）：
- 3天平均气温 = 20°C（只有1天，用当天值）
- 3天累积雨量 = 5mm
- 其他类似...

## 输出文件结构
输出文件包含以下列：
- 日期
- 3天平均气温
- 3天累积雨量
- 3天平均相对湿度
- 3天累积降雨时数
- 3天累积日照时数
- 5天平均气温
- 5天累积雨量
- 5天平均相对湿度
- 5天累积降雨时数
- 5天累积日照时数
- 7天平均气温
- 7天累积雨量
- 7天平均相对湿度
- 7天累积降雨时数
- 7天累积日照时数
- 10天平均气温
- 10天累积雨量
- 10天平均相对湿度
- 10天累积降雨时数
- 10天累积日照时数

## 注意事项
1. 确保输入文件名为"G1099.xlsx"或在脚本中修改文件名
2. 确保数据列顺序正确
3. 日期数据应该是可识别的日期格式
4. 其他数值列应该只包含数字，不能有文本

