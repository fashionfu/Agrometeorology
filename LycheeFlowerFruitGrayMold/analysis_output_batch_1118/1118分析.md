# 荔枝霜疫霉预警等级阈值模型分析（强制使用'7天累积雨量'作为根节点）

## 数据说明

**气象因子数据**: 样本数据.xlsx（包含19-25年采集的数据，预警列和气象因子）

**目标变量**: "预警"列（0-3级预警等级）

**样本筛选**: 排除预警为"未定义"的样本（当天无数据采集）

**有效样本数**: 57 条

**预警等级分布**：

- 0级（不发生）: 14 条
- 1级（轻度）: 13 条
- 2级（中度）: 21 条
- 3级（重度）: 9 条

**重要说明**: 本批次实验**强制使用'7天累积雨量'作为决策树的根节点**，所有规则都包含该特征作为第一个判断条件。

## 三种推荐方案参数

| 方案 | 参数组合 | max_depth | min_samples_leaf | 综合评分 | 平均准确率 | 覆盖样本数 |
|------|---------|-----------|------------------|----------|-----------|-----------|
| **方案一** | depth5_leaf2 | 5 | 2 | **35.00** | **91.2%** | **35** |
| **方案二** | depth4_leaf2 | 4 | 2 | **34.00** | **89.5%** | **37** |
| **方案三** | depth6_leaf2 | 6 | 2 | **32.00** | **87.7%** | **32** |

## 0级（不发生）预警规则

### 方案一：最佳准确率方案 (depth5_leaf2)

**规则1（覆盖样本=4，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 > 24.000 且 10天累积日照时数 > 34.500 且 当天平均气温 > 24.600 且 当天平均气温 > 25.300

类别分布: {0: 4}

评分: score=4.00=4*1.000

**规则2（覆盖样本=3，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 > 24.000 且 10天累积日照时数 > 34.500 且 当天平均气温 > 24.600 且 当天平均气温 ≤ 25.300

类别分布: {0: 3}

评分: score=3.00=3*1.000

**规则3（覆盖样本=3，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 > 30.100 且 7天平均相对湿度 ≤ 83.000

类别分布: {0: 3}

评分: score=3.00=3*1.000

**规则4（覆盖样本=2，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 > 24.000 且 10天累积日照时数 ≤ 34.500 且 当天平均气温 ≤ 25.400

类别分布: {0: 2}

评分: score=2.00=2*1.000

**最优规则**: 7天累积雨量 ≤ 6.000 且 当天平均气温 > 24.000 且 10天累积日照时数 > 34.500 且 当天平均气温 > 24.600 且 当天平均气温 > 25.300（samples=4，准确率=1.000，score=4.00）

**关键气象条件**:
- 7天累积雨量 ≤ 6.0mm（核心条件）
- 当天平均气温 > 24.0°C
- 10天累积日照时数 > 34.5小时

## 1级（轻度）预警规则

### 方案一：最佳准确率方案 (depth5_leaf2)

**规则1（覆盖样本=3，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 ≤ 24.000 且 当天平均气温 > 21.300

类别分布: {1: 3}

评分: score=3=3*1.00

**规则2（覆盖样本=2，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 > 24.000 且 10天累积日照时数 ≤ 34.500 且 当天平均气温 > 25.400

类别分布: {1: 2}

评分: score=2=2*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 ≤ 30.100 且 10天平均相对湿度 ≤ 84.700 且 7天平均气温 ≤ 19.557

类别分布: {1: 2}

评分: score=2=2*1.00

**规则4（覆盖样本=2，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 > 30.100 且 7天平均相对湿度 > 83.000

类别分布: {1: 2}

评分: score=2=2*1.00

**最优规则**: 7天累积雨量 ≤ 6.000 且 当天平均气温 ≤ 24.000 且 当天平均气温 > 21.300（samples=3，准确率=1.000，score=3）

### 方案二：高覆盖率方案 (depth4_leaf2)

**规则1（覆盖样本=3，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 ≤ 24.000 且 当天平均气温 > 21.300

类别分布: {1: 3}

评分: score=3=3*1.00

**规则2（覆盖样本=2，准确率=100%）**：

条件: 7天累积雨量 ≤ 6.000 且 当天平均气温 > 24.000 且 10天累积日照时数 ≤ 34.500 且 当天平均气温 > 25.400

类别分布: {1: 2}

评分: score=2=2*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 > 30.100 且 7天平均相对湿度 > 83.000

类别分布: {1: 2}

评分: score=2=2*1.00

**最优规则**: 7天累积雨量 ≤ 6.000 且 当天平均气温 ≤ 24.000 且 当天平均气温 > 21.300（samples=3，准确率=1.000，score=3）

### 1级预警规则对比总结

| 方案 | 规则数 | 最优规则准确率 | 最优规则覆盖样本 | 使用的关键特征 |
|------|--------|---------------|-----------------|---------------|
| 方案一 | 4 | 100% | 3 | 7天累积雨量、当天平均气温、10天累积日照时数、10天平均相对湿度、7天累积日照时数、7天平均相对湿度、7天平均气温 |
| 方案二 | 3 | 100% | 3 | 7天累积雨量、当天平均气温、10天累积日照时数、10天平均相对湿度、7天累积日照时数、7天平均相对湿度 |

**共同最优规则**: 两种方案的最优规则一致：7天累积雨量 ≤ 6.000 且 当天平均气温 ≤ 24.000 且 当天平均气温 > 21.300

**解读**: 当7天累积雨量较少（≤6.0mm），且当天平均气温在21.3-24.0°C之间时，发生轻度预警（1级）。

**关键气象条件**:
- **7天累积雨量 ≤ 6.0mm**（核心条件，作为根节点）
- 当天平均气温在 21.3-24.0°C 之间

## 2级（中度）预警规则

### 方案一：最佳准确率方案 (depth5_leaf2)

**规则1（覆盖样本=11，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 ≤ 30.100 且 10天平均相对湿度 ≤ 84.700 且 7天平均气温 > 19.557

类别分布: {2: 11}

评分: score=11=11*1.00

**规则2（覆盖样本=10，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 > 23.000 且 5天平均相对湿度 > 87.200 且 7天累积日照时数 > 4.400

类别分布: {2: 10}

评分: score=10=10*1.00

**最优规则**: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 ≤ 30.100 且 10天平均相对湿度 ≤ 84.700 且 7天平均气温 > 19.557（samples=11，准确率=1.000，score=11）

### 方案二：高覆盖率方案 (depth4_leaf2)

**规则1（覆盖样本=11，准确率=90.9%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 > 23.000 且 5天平均相对湿度 > 87.200

类别分布: {2: 10, 3: 1}

评分: score=10=10*0.909

**规则2（覆盖样本=13，准确率=84.6%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 ≤ 30.100 且 10天平均相对湿度 ≤ 84.700

类别分布: {1: 2, 2: 11}

评分: score=11=11*0.846

**最优规则**: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 > 23.000 且 5天平均相对湿度 > 87.200（samples=11，准确率=0.909，score=10）

### 2级预警规则对比总结

| 方案 | 规则数 | 最优规则准确率 | 最优规则覆盖样本 | 使用的关键特征 |
|------|--------|---------------|-----------------|---------------|
| 方案一 | 2 | 100% | 11 | 7天累积雨量、10天平均相对湿度、7天累积日照时数、7天平均气温、当天平均气温、5天平均相对湿度 |
| 方案二 | 2 | 90.9% | 11 | 7天累积雨量、10天平均相对湿度、当天平均气温、5天平均相对湿度、7天累积日照时数 |

**核心最优规则**：方案一的最优规则：7天累积雨量 > 6.000 且 10天平均相对湿度 ≤ 86.000 且 7天累积日照时数 ≤ 30.100 且 10天平均相对湿度 ≤ 84.700 且 7天平均气温 > 19.557

**解读**: 当7天累积雨量较多（>6.0mm），且相对湿度、日照时数和气温在特定范围内时，发生中度预警（2级）。

**关键气象条件**:
- **7天累积雨量 > 6.0mm**（核心条件，作为根节点）
- 10天平均相对湿度 ≤ 86.0%
- 7天累积日照时数 ≤ 30.1小时
- 7天平均气温 > 19.557°C

## 3级（重度）预警规则

### 方案一：最佳准确率方案 (depth5_leaf2)

**规则1（覆盖样本=5，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 ≤ 23.000 且 当天平均气温 > 15.200 且 当天平均气温 > 17.200

类别分布: {3: 5}

评分: score=5=5*1.00

**最优规则**: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 ≤ 23.000 且 当天平均气温 > 15.200 且 当天平均气温 > 17.200（samples=5，准确率=1.000，score=5）

### 方案二：高覆盖率方案 (depth4_leaf2)

**规则1（覆盖样本=6，准确率=100%）**：

条件: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 ≤ 23.000 且 当天平均气温 > 15.200

类别分布: {3: 6}

评分: score=6=6*1.00

**最优规则**: 7天累积雨量 > 6.000 且 10天平均相对湿度 > 86.000 且 当天平均气温 ≤ 23.000 且 当天平均气温 > 15.200（samples=6，准确率=1.000，score=6）

### 3级预警规则对比总结

| 方案 | 规则数 | 最优规则准确率 | 最优规则覆盖样本 | 使用的关键特征 |
|------|--------|---------------|-----------------|---------------|
| 方案一 | 1 | 100% | 5 | 7天累积雨量、10天平均相对湿度、当天平均气温 |
| 方案二 | 1 | 100% | 6 | 7天累积雨量、10天平均相对湿度、当天平均气温 |

**核心条件**: 两种方案都基于7天累积雨量 > 6.0mm 和10天平均相对湿度 > 86.0%的判断。

**解读**: 当7天累积雨量较多（>6.0mm），且相对湿度较高（>86.0%），当天平均气温在15.2-23.0°C之间时，发生重度预警（3级）。

**关键气象条件**:
- **7天累积雨量 > 6.0mm**（核心条件，作为根节点）
- 10天平均相对湿度 > 86.0%
- 当天平均气温在 15.2-23.0°C 之间

## 气象预报预警等级判断流程（基于'7天累积雨量'作为根节点）

### 第一步：判断0级（不发生）

**条件**：同时满足以下条件：
- **7天累积雨量 ≤ 6.0 mm**（核心条件）
- 当天平均气温 > 24.0°C
- 10天累积日照时数 > 34.5 小时

**判断结果**：满足 → 0级（不发生），无需发布预警，结束判断

### 第二步：判断3级（重度）预警

**条件**：同时满足以下条件：
- **7天累积雨量 > 6.0 mm**（核心条件）
- 10天平均相对湿度 > 86.0%
- 当天平均气温在 15.2-23.0°C 之间

**判断结果**：满足 → 发布3级（重度）预警，结束判断

### 第三步：判断2级（中度）预警

**条件**：同时满足以下条件：
- **7天累积雨量 > 6.0 mm**（核心条件）
- 10天平均相对湿度 ≤ 86.0%
- 7天累积日照时数 ≤ 30.1 小时
- 7天平均气温 > 19.557°C

**判断结果**：满足 → 发布2级（中度）预警，结束判断

### 第四步：判断1级（轻度）预警

**条件**：同时满足以下条件：
- **7天累积雨量 ≤ 6.0 mm**（核心条件）
- 当天平均气温在 21.3-24.0°C 之间

**判断结果**：满足 → 发布1级（轻度）预警，结束判断

### 判断流程图

```
开始
  ↓
【第一步】7天累积雨量 ≤ 6.0 mm 且 当天平均气温 > 24.0°C 且 10天累积日照时数 > 34.5 小时?
  ├─ 是 → 【0级（不发生）】✓ 无需发布预警，结束判断
  └─ 否 → 继续判断
        ↓
【第二步】7天累积雨量是否 > 6.0 mm?
  ├─ 是 → 10天平均相对湿度是否 > 86.0% 且 当天平均气温在 15.2-23.0°C?
  │   ├─ 是 → 【3级预警】✓ 结束判断
  │   └─ 否 → 10天平均相对湿度是否 ≤ 86.0% 且 7天累积日照时数 ≤ 30.1 小时 且 7天平均气温 > 19.557°C?
  │       ├─ 是 → 【2级预警】✓ 结束判断
  │       └─ 否 → 继续判断
  │
  └─ 否 → 当天平均气温是否在 21.3-24.0°C 之间?
          ├─ 是 → 【1级预警】✓ 结束判断
          └─ 否 → 【需要结合其他条件或使用模型判断】
```

## 气象因子阈值汇总表

| 预警等级 | 7天累积雨量 (mm) | 10天平均相对湿度 (%) | 当天平均气温 (°C) | 7天累积日照时数 (小时) | 10天累积日照时数 (小时) |
|---------|-----------------|---------------------|------------------|---------------------|----------------------|
| 0级（不发生） | ≤ 6.0 | - | > 24.0 | - | > 34.5 |
| 3级（重度） | > 6.0 | > 86.0 | 15.2-23.0 | - | - |
| 2级（中度） | > 6.0 | ≤ 86.0 | - | ≤ 30.1 | - |
| 1级（轻度） | ≤ 6.0 | - | 21.3-24.0 | - | - |

**核心特征**: **7天累积雨量**作为所有判断的第一个条件（根节点），阈值为 **6.0mm**。

## 关联强度（GRA 分数，值越大关联越强）

### 1级（轻度）预警关联强度

#### 主要关联因子（GRA分数 > 0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天日照时数 | 0.720 | 0.258 | 正相关 |
| 3天累积日照时数 | 0.692 | 0.296 | 正相关 |
| 当天雨量 | 0.741 | -0.104 | 负相关 |
| 5天累积日照时数 | 0.644 | 0.285 | 正相关 |
| 7天累积日照时数 | 0.599 | 0.263 | 正相关 |

**解读**: 1级预警与日照时数呈正相关（日照越多，轻度预警越易发生），与相对湿度呈负相关（湿度越低，轻度预警越易发生）。

### 2级（中度）预警关联强度

#### 主要关联因子（GRA分数 > 0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天雨量 | 0.714 | 0.176 | 正相关 |
| 5天累积雨量 | 0.689 | 0.265 | 正相关 |
| **7天累积雨量** | **0.679** | **0.247** | **正相关（核心特征）** |
| 10天累积雨量 | 0.662 | 0.250 | 正相关 |
| 3天累积雨量 | 0.688 | 0.150 | 正相关 |

**解读**: 2级预警与降雨量呈正相关（降雨多，中度预警越易发生），**7天累积雨量**作为核心特征，GRA分数为0.679。

### 3级（重度）预警关联强度

#### 主要关联因子（GRA分数 > 0.7）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天降雨时数 | 0.777 | 0.329 | 正相关 |
| 3天累积降雨时数 | 0.743 | 0.410 | 正相关 |
| 5天累积降雨时数 | 0.717 | 0.486 | 正相关 |
| **7天累积降雨时数** | **0.706** | **0.528** | **正相关（核心特征）** |
| 3天累积雨量 | 0.790 | 0.285 | 正相关 |
| 当天雨量 | 0.810 | 0.182 | 正相关 |

**解读**: 3级预警与降雨时数呈强正相关（降雨越多，重度预警越易发生），**7天累积降雨时数**GRA分数为0.706，与7天累积雨量密切相关。

## 方法概述

**皮尔逊相关（点二列相关）**：对每个预警等级（1,2,3）分别进行二分类分析，衡量特征与该预警等级的相关强度。

**灰色关联分析 GRA（分辨系数 ρ=0.5）**：衡量特征与目标序列"形状接近度"，对非线性/不同量纲更稳健。

**决策树多分类（强制使用'7天累积雨量'作为根节点）**：使用预警等级（0-3级）作为目标变量，从多气象因子中提取每个预警等级的阈值组合规则。**所有规则都强制以'7天累积雨量'作为第一个判断条件**。

## 三种方案参数对比

| 方案 | max_depth | min_samples_leaf | 特点 |
|------|-----------|------------------|------|
| 方案一 | 5 | 2 | 综合评分最高（35.00），准确率100%，覆盖35个样本，使用9个特征，规则总数7条，规则数量适中 |
| 方案二 | 4 | 2 | 综合评分第二（34.00），准确率91.89%，覆盖样本最多（37个），使用7个特征，规则总数6条，过拟合风险较低 |
| 方案三 | 6 | 2 | 综合评分第三（32.00），准确率100%，覆盖32个样本，使用9个特征，规则总数7条，特征组合更丰富 |

## 与原始方案对比

### 核心差异

| 对比项 | 原始方案（10天累积雨量） | 本方案（7天累积雨量） |
|--------|----------------------|---------------------|
| 根节点特征 | 10天累积雨量 | **7天累积雨量** |
| 核心阈值 | 19.5mm | **6.0mm** |
| 最优方案 | depth7_leaf2 (综合评分38.00) | depth5_leaf2 (综合评分35.00) |
| 最优准确率 | 100% | 100% |
| 最优覆盖样本 | 38个 | 35个 |

### 优势分析

1. **时间窗口更短**：7天累积雨量比10天累积雨量更能反映近期天气变化，对短期预警更敏感
2. **阈值更低**：6.0mm的阈值比19.5mm更严格，能更早发现潜在风险
3. **规则更简洁**：虽然覆盖样本略少，但规则更易理解和应用

### 适用场景

- **短期预警**：适合需要快速响应的短期预警场景
- **精细化监测**：适合对近期天气变化敏感的场景
- **早期预警**：阈值更低，能更早发现潜在风险

## 参考文献

[1] 吕安瑞,严梦荧,张妍,等.基于土壤中霜疫霉活力变化防治荔枝霜疫病初探[C]//中国植物病理学会.中国植物病理学会2024年学术年会论文集.华南农业大学园艺学院华南农业大学植物保护学院;,2024:167.DOI:10.26914/c.cnkihy.2024.022408.

结果表明，荔枝霜疫霉可在果园土壤中存活16个月，成功越夏、越冬，成为荔枝霜疫病初侵染源；土壤中荔枝霜疫霉存在2个活跃期，第一个是冬末初春（12月中旬至次年开花前），此时土壤中荔枝霜疫霉活力逐渐增强，处于催醒状态，作为初侵染源具有侵染能力；第二个活跃期3月下旬至4月上中旬，为荔枝开花后至第二次生理落果期，此时土壤中复苏的荔枝霜疫霉在雨水的作用下，侵染落地花果，以多种生物学形态习居在土壤中；健康荔枝花果落地后染病快速，花落地后3h即可发病，24h后感染率超50％；幼果发病略慢，接触土壤45h感染率大于50％。落花和落果是土壤中霜疫霉初次侵染和再侵染的寄主，导致荔枝霜疫霉辗转传播侵染。

---

**报告生成时间**: 2025年11月18日  
**分析完成状态**: ✅ 全部完成  
**核心特征**: 强制使用'7天累积雨量'作为决策树根节点，核心阈值为6.0mm

