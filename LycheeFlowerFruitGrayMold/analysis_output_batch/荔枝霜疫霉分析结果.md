# 荔枝霜疫霉预警等级阈值模型分析

## 数据说明

**气象因子数据**: 样本数据.xlsx（包含19-25年采集的数据，预警列和气象因子）

**感染率数据**: 张桂香19-25校内大果园花果带菌率数据分析--给张工分析数据-10.20.xlsx

**目标变量**: "预警"列（0-3级预警等级）

**样本筛选**: 排除预警为"未定义"的样本（当天无数据采集）

**有效样本数**: 57 条

**预警等级分布**：

- 0级（不发生）: 14 条
- 1级（轻度）: 13 条
- 2级（中度）: 21 条
- 3级（重度）: 9 条

## 三种推荐方案参数

| 方案 | 参数组合 | max_depth | min_samples_leaf | 综合评分 | 平均准确率 |
|------|---------|-----------|------------------|----------|-----------|
| **方案一** | depth7_leaf2 | 7 | 2 | **38.00** | **93.0%** |
| **方案二** | depth6_leaf2 | 6 | 2 | **36.00** | **93.0%** |
| **方案三** | depth5_leaf2 | 5 | 2 | **32.00** | **89.5%** |

## 0级（不发生）预警规则

**0级（不发生）预警规则**

**规则1（覆盖样本=11，准确率=100.0%）**：

条件: 10天累积雨量 ≤ 19.500 且 当天相对湿度 > 74.500 且 10天累积日照时数 > 29.550

类别分布: {0: 11, 1: 0, 2: 0, 3: 0}

评分: score=11.00=11*1.000

**最优规则**: 10天累积雨量 ≤ 19.500 且 当天相对湿度 > 74.500 且 10天累积日照时数 > 29.550（samples=11，准确率=1.000，score=11.00）

## 1级（轻度）预警规则

### 方案一：最佳准确率方案 (depth7_leaf2)

**规则1（覆盖样本=6，准确率=100%）**：

条件: 10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500

类别分布: {1: 6}

评分: score=6=6*1.00

**规则2（覆盖样本=4，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 > 8.300 且 5天累积雨量 > 26.800 且 当天相对湿度 > 89.000

类别分布: {1: 4}

评分: score=4=4*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 10天累积雨量 ≤ 19.500 且 当天相对湿度 > 74.500 且 10天累积日照时数 ≤ 29.550 且 10天平均相对湿度 > 75.500

类别分布: {1: 2}

评分: score=2=2*1.00

**最优规则**: 10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500（samples=6，准确率=1.000，score=6）

### 方案二：同步最佳准确率方案 (depth6_leaf2)

**规则1（覆盖样本=6，准确率=100%）**：

条件: 10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500

类别分布: {1: 6}

评分: score=6=6*1.00

**规则2（覆盖样本=4，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 > 8.300 且 5天累积雨量 > 26.800 且 当天相对湿度 > 89.000

类别分布: {1: 4}

评分: score=4=4*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 10天累积雨量 ≤ 19.500 且 当天相对湿度 > 74.500 且 10天累积日照时数 ≤ 29.550 且 10天平均相对湿度 > 75.500

类别分布: {1: 2}

评分: score=2=2*1.00

**最优规则**: 10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500（samples=6，准确率=1.000，score=6）

### 方案三：准确率方案 (depth5_leaf2)

**规则1（覆盖样本=6，准确率=100%）**：

条件: 10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500

类别分布: {1: 6}

评分: score=6=6*1.00

**最优规则**: 10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500（samples=6，准确率=1.000，score=6）

### 1级预警规则对比总结

| 方案 | 规则数 | 最优规则准确率 | 最优规则覆盖样本 | 使用的关键特征 |
|------|--------|---------------|-----------------|---------------|
| 方案一 | 3 | 100% | 6 | 10天累积雨量、当天相对湿度、10天累积日照时数、3天累积降雨时数、5天累积日照时数、5天累积雨量、10天平均相对湿度 |
| 方案二 | 3 | 100% | 6 | 与方案一相同 |
| 方案三 | 2 | 100% | 6 | 10天累积雨量、当天相对湿度、10天累积日照时数、10天平均相对湿度 |

**共同最优规则**: 三种方案的最优规则一致：10天累积雨量 ≤ 19.500 且 当天相对湿度 ≤ 74.500

**解读**: 当10天累积雨量较少（≤19.5mm），且当天相对湿度较低（≤74.5%）时，发生轻度预警（1级）。

**关键气象条件**:

- 10天累积雨量 ≤ 19.5mm
- 当天相对湿度 ≤ 74.5%

## 2级（中度）预警规则

### 方案一：最佳准确率方案 (depth7_leaf2)

**规则1（覆盖样本=10，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500

类别分布: {2: 10}

评分: score=10=10*1.00

**规则2（覆盖样本=7，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 ≤ 8.300 且 当天降雨时数 ≤ 17.000

类别分布: {2: 7}

评分: score=7=7*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 > 8.300 且 5天累积雨量 ≤ 26.800

类别分布: {2: 2}

评分: score=2=2*1.00

**最优规则**: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500（samples=10，准确率=1.000，score=10）

### 方案二：同步最佳方案 (depth6_leaf2)

**规则1（覆盖样本=10，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500

类别分布: {2: 10}

评分: score=10=10*1.00

**规则2（覆盖样本=7，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 ≤ 8.300 且 当天降雨时数 ≤ 17.000

类别分布: {2: 7}

评分: score=7=7*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 > 8.300 且 5天累积雨量 ≤ 26.800

类别分布: {2: 2}

评分: score=2=2*1.00

**最优规则**: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500（samples=10，准确率=1.000，score=10）

### 方案三：高准确率方案 (depth5_leaf2)

**规则1（覆盖样本=10，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500

类别分布: {2: 10}

评分: score=10=10*1.00

**规则2（覆盖样本=7，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 ≤ 8.300 且 当天降雨时数 ≤ 17.000

类别分布: {2: 7}

评分: score=7=7*1.00

**规则3（覆盖样本=2，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 > 8.300 且 5天累积雨量 ≤ 26.800

类别分布: {2: 2}

评分: score=2=2*1.00

**最优规则**: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500（samples=10，准确率=1.000，score=10）

### 2级预警规则对比总结

| 方案 | 规则数 | 最优规则准确率 | 最优规则覆盖样本 | 使用的关键特征 |
|------|--------|---------------|-----------------|---------------|
| 方案一 | 3 | 100% | 10 | 10天累积雨量、10天累积日照时数、3天累积降雨时数、3天累积日照时数、5天累积日照时数、当天降雨时数、5天累积雨量 |
| 方案二 | 3 | 100% | 10 | 与方案一相同 |
| 方案三 | 3 | 100% | 10 | 与方案一相同 |

**核心最优规则**： 三种方案的最优规则一致：10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 ≤ 8.000 且 3天累积日照时数 ≤ 19.500

解读: 当10天累积雨量较多（>19.5mm），且累积日照时数和累积降雨时数在特定范围内时，发生中度预警（2级）。三种方案都使用相同的核心阈值条件。

**关键气象条件**:

- 10天累积雨量 > 19.5mm
- 10天累积日照时数 > 5.9小时
- 3天累积降雨时数 ≤ 8.0小时
- 3天累积日照时数 ≤ 19.5小时

**方案一特点**: 深度较深，有3条规则，使用更多特征组合，覆盖样本数最多（10个）。

## 3级（重度）预警规则

### 方案一：最佳准确率方案 (depth7_leaf2)

**规则1（覆盖样本=5，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 ≤ 5.900

类别分布: {3: 5}

评分: score=5=5*1.00

**规则2（覆盖样本=2，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 > 5.900 且 3天累积降雨时数 > 8.000 且 5天累积日照时数 > 8.300 且 5天累积雨量 > 26.800 且 当天相对湿度 ≤ 89.000 且 当天平均气温 ≤ 24.450

类别分布: {3: 2}

评分: score=2=2*1.00

**最优规则**: 10天累积雨量 > 19.500 且 10天累积日照时数 ≤ 5.900（samples=5，准确率=1.000，score=5）

**关键优势**: 深度较深，使用特征组合更丰富，有2条规则覆盖3级预警样本。

### 方案二：同步最佳方案 (depth6_leaf2)

**规则1（覆盖样本=5，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 ≤ 5.900

类别分布: {3: 5}

评分: score=5=5*1.00

**最优规则**: 10天累积雨量 > 19.500 且 10天累积日照时数 ≤ 5.900（samples=5，准确率=1.000，score=5）

**关键优势**: 整体准确率93.0%，与方案一并列最高，参数设置适中（深度6层），规则数量适中（7条），达到100%准确率。

### 方案三：高准确率方案 (depth5_leaf2)

**规则1（覆盖样本=5，准确率=100%）**：

条件: 10天累积雨量 > 19.500 且 10天累积日照时数 ≤ 5.900

类别分布: {3: 5}

评分: score=5=5*1.00

**最优规则**: 10天累积雨量 > 19.500 且 10天累积日照时数 ≤ 5.900（samples=5，准确率=1.000，score=5）

**关键特点**: 整体准确率89.5%，参数设置适中（深度5层），规则简洁（6条），达到100%准确率，过拟合风险较低。

### 3级预警规则对比总结

| 方案 | 规则数 | 最优规则准确率 | 最优规则覆盖样本 | 使用的关键特征 | 短期特征使用 |
|------|--------|---------------|-----------------|---------------|-------------|
| 方案一 | 2 | 100% | 5 | 10天累积雨量、10天累积日照时数、3天累积降雨时数、5天累积日照时数、5天累积雨量、当天相对湿度、当天平均气温 | 当天平均气温 ≤ 24.450（规则2） |
| 方案二 | 1 | 100% | 5 | 10天累积雨量、10天累积日照时数 | - |
| 方案三 | 1 | 100% | 5 | 10天累积雨量、10天累积日照时数 | - |

**核心条件**: 三种方案都基于10天累积雨量 > 19.5mm 和10天累积日照时数 ≤ 5.9小时的判断。

**解读**: 当10天累积雨量较多（>19.5mm），且累积日照时数较少时，发生重度预警（3级）。三种方案都使用10天累积日照时数 ≤ 5.900小时作为核心阈值。

**关键气象条件**:

- 10天累积雨量 > 19.5mm
- 10天累积日照时数 ≤ 5.9小时

**方案一特点**: 深度较深，有2条规则，使用更多特征组合，能覆盖更多细分场景。

## 气象预报预警等级判断流程（判断顺序：0级 → 3级 → 2级 → 1级）

### 第一步：判断0级（不发生）

**条件**：同时满足以下三个条件：

- 10天累积雨量 ≤ 19.5 mm
- 当天相对湿度 > 74.5%
- 10天累积日照时数 > 29.55 小时

**判断结果**：满足 → 0级（不发生），无需发布预警，结束判断

### 第二步：判断3级（重度）预警

**条件**：同时满足以下两个条件：

- 10天累积雨量 > 19.5 mm
- 10天累积日照时数 ≤ 5.9 小时

**判断结果**：满足 → 发布3级（重度）预警，结束判断

### 第三步：判断2级（中度）预警

**条件**：同时满足以下四个条件：

- 10天累积雨量 > 19.5 mm
- 10天累积日照时数 > 5.9 小时
- 3天累积降雨时数 ≤ 8.0 小时
- 3天累积日照时数 ≤ 19.5 小时

**判断结果**：满足 → 发布2级（中度）预警，结束判断

### 第四步：判断1级（轻度）预警

**条件**：同时满足以下两个条件：

- 10天累积雨量 ≤ 19.5 mm
- 当天相对湿度 ≤ 74.5%

**判断结果**：满足 → 发布1级（轻度）预警，结束判断

### 判断流程图

```
开始
  ↓
【第一步】10天累积雨量 ≤ 19.5 mm 且 当天相对湿度 > 74.5% 且 10天累积日照时数 > 29.55 小时?
  ├─ 是 → 【0级（不发生）】✓ 无需发布预警，结束判断
  └─ 否 → 继续判断
        ↓
【第二步】10天累积雨量是否 > 19.5 mm?
  ├─ 是 → 10天累积日照时数是否 ≤ 5.9 小时?
  │   ├─ 是 → 【3级预警】✓ 结束判断
  │   └─ 否 → 10天累积日照时数是否 > 5.9 小时 且 3天累积降雨时数 ≤ 8.0 小时 且 3天累积日照时数 ≤ 19.5 小时?
  │       ├─ 是 → 【2级预警】✓ 结束判断
  │       └─ 否 → 继续判断
  │
  └─ 否 → 当天相对湿度是否 ≤ 74.5%?
          ├─ 是 → 【1级预警】✓ 结束判断
          └─ 否 → 【需要结合其他条件或使用模型判断】
```

## 气象因子阈值汇总表

| 预警等级 | 10天累积雨量 (mm) | 当天相对湿度 (%) | 10天累积日照时数 (小时) | 当天平均气温 (°C) |
|---------|------------------|-----------------|----------------------|------------------|
| 0级（不发生） | ≤ 19.5 | > 74.5 | > 29.55 | - |
| 3级（重度） | > 19.5 | - | ≤ 5.9 | - |
| 2级（中度） | > 19.5 | - | > 5.9 且 ≤ 19.5（3天累积日照时数） | - |
| 1级（轻度） | ≤ 19.5 | ≤ 74.5 | - | - |

## 关联强度（GRA 分数，值越大关联越强）

### 1级（轻度）预警关联强度

#### 主要关联因子（GRA分数 > 0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天日照时数 | 0.720 | 0.258 | 正相关 |
| 3天累积日照时数 | 0.692 | 0.296 | 正相关 |
| 当天雨量 | 0.741 | -0.104 | 负相关 |
| 5天累积日照时数 | 0.644 | 0.285 | 正相关 |
| 7天累积日照时数 | 0.599 | 0.263 | 正相关 |

#### 次要关联因子（GRA分数 0.5-0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 7天平均相对湿度 | 0.624 | -0.345 | 负相关 |
| 5天平均相对湿度 | 0.574 | -0.390 | 负相关 |
| 10天累积日照时数 | 0.590 | 0.228 | 正相关 |
| 3天累积雨量 | 0.699 | -0.205 | 负相关 |

**解读**: 1级预警与日照时数呈正相关（日照越多，轻度预警越易发生），与相对湿度呈负相关（湿度越低，轻度预警越易发生）。

### 2级（中度）预警关联强度

#### 主要关联因子（GRA分数 > 0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天雨量 | 0.714 | 0.176 | 正相关 |
| 5天累积雨量 | 0.689 | 0.265 | 正相关 |
| 7天累积雨量 | 0.679 | 0.247 | 正相关 |
| 10天累积雨量 | 0.662 | 0.250 | 正相关 |
| 3天累积雨量 | 0.688 | 0.150 | 正相关 |

#### 次要关联因子（GRA分数 0.5-0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 5天平均相对湿度 | 0.571 | 0.357 | 正相关 |
| 3天平均相对湿度 | 0.560 | 0.299 | 正相关 |
| 10天平均相对湿度 | 0.562 | 0.306 | 正相关 |
| 5天累积日照时数 | 0.554 | -0.311 | 负相关（日照少更易发生） |
| 3天累积日照时数 | 0.573 | -0.245 | 负相关（日照少更易发生） |

**解读**: 2级预警与降雨量和相对湿度呈正相关（降雨多、湿度高，中度预警越易发生），与日照时数呈负相关（日照少，中度预警越易发生）。

### 3级（重度）预警关联强度

#### 主要关联因子（GRA分数 > 0.7）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天降雨时数 | 0.777 | 0.329 | 正相关 |
| 3天累积降雨时数 | 0.743 | 0.410 | 正相关 |
| 5天累积降雨时数 | 0.717 | 0.486 | 正相关 |
| 7天累积降雨时数 | 0.706 | 0.528 | 正相关 |
| 3天累积雨量 | 0.790 | 0.285 | 正相关 |
| 当天雨量 | 0.810 | 0.182 | 正相关 |

#### 次要关联因子（GRA分数 0.6-0.7）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 当天日照时数 | 0.665 | -0.223 | 负相关（日照少更易发生） |
| 7天累积日照时数 | 0.654 | -0.372 | 负相关（日照少更易发生） |
| 10天累积降雨时数 | 0.657 | 0.557 | 正相关 |
| 10天累积日照时数 | 0.602 | -0.460 | 负相关（日照少更易发生） |

#### 其他关联因子（GRA分数 0.5-0.6）

| 因子 | GRA分数 | Pearson相关系数 | 说明 |
|------|---------|----------------|------|
| 10天平均相对湿度 | 0.544 | 0.454 | 正相关 |
| 7天平均相对湿度 | 0.516 | 0.375 | 正相关 |

**解读**: 3级预警与降雨时数呈强正相关（降雨越多，重度预警越易发生），与日照时数呈强负相关（日照越少，重度预警越易发生），与相对湿度呈正相关（湿度越高，重度预警越易发生）。

## 方法概述

**皮尔逊相关（点二列相关）**：对每个预警等级（1,2,3）分别进行二分类分析，衡量特征与该预警等级的相关强度。

**灰色关联分析 GRA（分辨系数 ρ=0.5）**：衡量特征与目标序列"形状接近度"，对非线性/不同量纲更稳健。

**决策树多分类**：使用预警等级（0-3级）作为目标变量，从多气象因子中提取每个预警等级的阈值组合规则。

## 三种方案参数对比

| 方案 | max_depth | min_samples_leaf | 特点 |
|------|-----------|------------------|------|
| 方案一 | 7 | 2 | 深度较深，使用最多特征（10个），特征组合更丰富，规则总数最多（8条），整体准确率最高（93.0%），覆盖样本最多（38个） |
| 方案二 | 6 | 2 | 整体准确率并列最高（93.0%），参数设置适中（深度6层），使用特征数较多（9个），规则总数适中（7条），覆盖样本36个 |
| 方案三 | 5 | 2 | 整体准确率较高（89.5%），参数设置适中（深度5层），使用特征数较多（9个），规则总数适中（6条），覆盖样本32个，过拟合风险较低 |

## 参考文献

[1] 吕安瑞,严梦荧,张妍,等.基于土壤中霜疫霉活力变化防治荔枝霜疫病初探[C]//中国植物病理学会.中国植物病理学会2024年学术年会论文集.华南农业大学园艺学院华南农业大学植物保护学院;,2024:167.DOI:10.26914/c.cnkihy.2024.022408.

结果表明，荔枝霜疫霉可在果园土壤中存活16个月，成功越夏、越冬，成为荔枝霜疫病初侵染源；土壤中荔枝霜疫霉存在2个活跃期，第一个是冬末初春（12月中旬至次年开花前），此时土壤中荔枝霜疫霉活力逐渐增强，处于催醒状态，作为初侵染源具有侵染能力；第二个活跃期3月下旬至4月上中旬，为荔枝开花后至第二次生理落果期，此时土壤中复苏的荔枝霜疫霉在雨水的作用下，侵染落地花果，以多种生物学形态习居在土壤中；健康荔枝花果落地后染病快速，花落地后3h即可发病，24h后感染率超50％；幼果发病略慢，接触土壤45h感染率大于50％。落花和落果是土壤中霜疫霉初次侵染和再侵染的寄主，导致荔枝霜疫霉辗转传播侵染。

---

**报告生成时间**: 2025年11月6日  
**分析完成状态**: ✅ 全部完成

